# Управление памятью

В JavaScript же память выделяется динамически при создании сущностей (т.е., объектов, строк и т.п.) и "автоматически" освобождается, когда они больше не используются.

-   JavaScript динамически выделяет необходимую память при объявлении переменных

```js
var n = 123; // выделяет память для типа number
var s = "azerty"; // выделяет память для типа string
```

-   для типа object и всех его внутренних свойвств

```js
var o = {
    a: 1,
    b: null,
};
```

-   выделяет память для array и его внутренних значений

```js
var a = [1, null, "abra"];
```

-   выделяет память для function

```js
function f(a) {
    return a + 2;
}
```

-   вызовы некоторых функций также ведут к выделению памяти под объект

```js
var d = new Date();
var e = document.createElement("div"); // выделяет память под DOM-элемент
```

## Достижимость

-   Объект считается подлежащим уничтожению сборщиком мусора, если количество ссылок на него равно нулю

1. Существует базовое множество достижимых значений, которые не могут быть удалены.

Например:

-   Выполняемая в данный момент функция, её локальные переменные и параметры.
-   Другие функции в текущей цепочке вложенных вызовов, их локальные переменные и параметры.
-   Глобальные переменные.
-   (некоторые другие внутренние значения) Эти значения мы будем называть корнями.

2. Любое другое значение считается достижимым, если оно доступно из корня по ссылке или по цепочке ссылок.

```js
let user = {
    name: "John",
};

let admin = user;
user = null;
console.log("admin: ", admin);
```

## Циклическая ссылка

Циклическая ссылка возникает, когда два объекта создаются со свойствами, которые ссылаются друг на друга, тем самым создавая цикл.


```js
let one = {};
let two = {};

// one reference to two
one.object = two;

// two reference to one
two.object = one;
```

- Циклические ссылки являются одной из основных причин утечек памяти.